# Домашнее задание к занятию «Введение в микросервисы»

## Задача 1: Интернет Магазин

Руководство крупного интернет-магазина, у которого постоянно растёт пользовательская база и количество заказов, рассматривает возможность переделки своей внутренней   ИТ-системы на основе микросервисов. 

Вас пригласили в качестве консультанта для оценки целесообразности перехода на микросервисную архитектуру. 

Опишите, какие выгоды может получить компания от перехода на микросервисную архитектуру и какие проблемы нужно решить в первую очередь.

---

### Как оформить ДЗ?

Выполненное домашнее задание пришлите ссылкой на .md-файл в вашем репозитории.

---

### Ответ

После перехода на микросервисы наша компания получит следующие преимущества:
- Возможность использовать разные технологии. Мы можем использовать разные стеки технологий под разные типы задач, это увеличит гибкость и производительность системы.
- Устойчивость к ошибкам. 
- Масштабируемость. Мы можем увеличить количество экземпляров наиболее нагруженных сервисов (например, СУБД) и добавить балансировщик запросов. При неободимости мы сможем увеличить количество ресурсов, выделяемых каждому экземпляру сервиса. Для менее нагруженных сервисов можно выделить меньше ресурсов, таким образом мы перераспределяем ресурсы.
- Простота развёртывания. Развёртывание становится чаще и надёжнее, на каждое небольшое изменение в коде, новая функциональность попадает в релиз гораздо быстрее. При необходимости мы можем вернуться к предыдущей версии сервиса.
- Простота замены. Мы всегда можем переписать каждый сервис на другой язык программирования или под другой стек для ускорения работы.
- Отражение структуры организации. Мы можем создать кроссфункциональные команды для разработки и эксплуатации каждого сервиса нашей системы.

После перехода мы столкнёмся со следующими проблемами:
- Проблемы разработки: совместимость API (обратная и прямая совместимость, релиз одного сервиса не должен зависит от релиза другого), версионирование артефактов (нужно понимать, какие библиотеки использует каждый сервис), автоматизация сборки и тестирования (нужна автоматизация рутинных операций), документация (нужно поддерживать постоянную актуализацию документацию), инфраструктура разработки (нужны шаблоны и скрипты быстрого создания сервисов, нужен пакетный репозиторий для распространения библиотек и модулей)
- Проблемы эксплуатации: мониторинг (слежение за состоянием систем, стандартизированные правила мониторинга технических и бизнес-показателей), сбор логов (нужна система сбора и анализа логов), управление настройками (централизированная система управления конфигурацией), управление инфраструктурой (стандартизация и автоматизация инфраструктуры)

- Развертывание функции, требующей внесения изменений более чем в один микросервис, обходится дорого. Надо координировать работу каждого сервиса и отдельных команд, и тщательно отслеживать порядок развертывания новых версий этих сервисов. Это потребует гораздо большего объема работ, чем внесение таких же преобразований внутри одного сервиса (или внутри монолита). Следовательно, нужно найти способы сделать межсервисные изменения как можно более редкими.
- Технологическая перегрузка. Архитектура микросервисов вполне может предоставить возможность на- писать каждый микросервис на отдельном языке программирования, выполнять его в своей среде или использовать отдельную базу данных, но это возможности, а не требования. Необходимо найти баланс масштабности и сложности используемой технологии с издержками, которые она может повлечь. В самом начале внедрения микросервисов неизбежны некоторые фундаментальные проблемы: затраты времени на понимание проблем, связанных с согласованностью данных, задержкой, моделированием сервисов. Нужно внедрять новые сервисы в свою микросервисную архитектуру по мере необходимости. Мы не только не будем перегружены сложностью этих инструментов, но и получим больше вариантов решения задач, которые, несомненно, появятся со временем.
- Стоимость. Сразу после перехода на микросервисы мы увидим увеличение затрат из-за того, что потребуется запускать больше процессов, сетей, виртуальных машин, хранилищ и покупать больше вспомогательного ПО. Также изменения, вносиме в команду и организацию, замедлят процесс работы. Чтобы изучить новые идеи и понять, как их эффективно использовать, потребуется время. Это приведет либо к прямому замедлению рабочего процесса, либо к необходимости добавить больше сотрудников, чтобы компенсировать эти затраты.
- Отчётность. Значительно усложнится отчётность, так как мы перейдём от монолитной базы данных к потоковой передаче данных в режиме реального времени. В качестве альтернативы можно просто публиковать данные из микросервисов в централизованных базах данных отчетов.
- Мониторинг и устранение неполадок. Необходимо изменить подход к мониторингу, так как придётся мониторить каждый процесс. Нужно распределить процессы по важности и подготовить новые метрики и алёрты для них.
- Безопасность. В однопроцессной монолитной системе большая часть информации протекала в рамках этого же процесса. Теперь больше информации передается по сетям между нашими сервисами. Это может повлечь утечку данных при передаче, а также позволит манипулировать ими в рамках кибератак типа «человек посередине». Это означает, что нам потребуется уделять больше внимания защите передаваемых данных, чтобы только авторизованные лица имели к ним доступ.
- Тестирование. С микросервисной архитектурой объем тестов становится очень внушительным. Теперь потребуется запускать тесты в нескольких процессах, и все они должны быть развернуты и соответствующим образом настроены для тестовых сценариев. Также необходимо быть готовыми к ложным срабатываниям, возникающим, когда проблемы с окружающей средой, такие как отказ экземпляров сервисов или сетевые таймауты неудачных развертываний, приводят к сбою тестов.
- Время ожидания. Благодаря микросервисной архитектуре обработку, которую ранее можно было выполнять только локально на одном процессоре, теперь можно разделить на несколько отдельных микросервисов. Это может привести к увеличению времени ожидания в вашей системе. Нужно пользоваться инструментами трассировки для замера сквозного времени ожидания для операций.
- Согласованность данных. Переход от монолита, где данные хранятся и управляются в единой базе данных, к распределенной системе, в которой несколько процессов управляют состоянием в разных БД, создает потенциальные проблемы в отношении согласованности данных. Использование распределенных транзакций в большинстве случаев оказывается весьма проблематичным при координации изменений состояния. Вместо этого, возможно, придется использовать такие концепции, как саги и согласованность в конечном счете, чтобы управлять состоянием системы и анализировать его.